From: "Barak A. Pearlmutter" <barak+git@pearlmutter.net>
Date: Mon, 31 Aug 2015 20:18:42 +0100
Subject: reenable site-init

The upstream build scripts invoke emacs with the -Q option, --quick.
As documented,

  $ man emacs | egrep -A1 '[-][qQ]|site-file'
		-q, --no-init-file
			Do not load an init file.
  --
		--no-site-file
			Do not load the site-wide startup file.
  --
		-Q, --quick
			Similar to "-q --no-site-file --no-splash".  Also, avoid processing X resources.

this does not load the site initialization files.  But in Debian, the
site initialization file needs to be loaded, in order to allow access
to other elisp packages.  This patch uses the -q option instead, so
the user-specific init file is not loaded, but the site one is.

Forwarded: no
Author: Barak A. Pearlmutter <barak@pearlmutter.net>
---
 Documentation/Makefile | 6 +++---
 Makefile               | 2 +-
 default.mk             | 2 +-
 3 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/Documentation/Makefile b/Documentation/Makefile
index 66369c9..84f4526 100644
--- a/Documentation/Makefile
+++ b/Documentation/Makefile
@@ -20,15 +20,15 @@ texi: $(TEXIPAGES)
 	@printf "WARNING: Discard these whitespace errors before committing.\n"
 	@printf "WARNING: Also see https://github.com/magit/magit/issues/1912.\n"
 	@printf "Generating magit.texi\n"
-	@$(EMACSBIN) -batch -Q $(DOC_LOAD_PATH) \
+	@$(EMACSBIN) -batch -q $(DOC_LOAD_PATH) \
 	-l ox-texinfo+.el magit.org -f org-texinfo+export-to-texinfo
 	@echo >> magit.texi
 	@printf "Generating magit-popup.texi\n"
-	@$(EMACSBIN) -batch -Q $(DOC_LOAD_PATH) \
+	@$(EMACSBIN) -batch -q $(DOC_LOAD_PATH) \
 	-l ox-texinfo+.el magit-popup.org -f org-texinfo+export-to-texinfo
 	@echo >> magit-popup.texi
 	@printf "Generating with-editor.texi\n"
-	@$(EMACSBIN) -batch -Q $(DOC_LOAD_PATH) \
+	@$(EMACSBIN) -batch -q $(DOC_LOAD_PATH) \
 	-l ox-texinfo+.el with-editor.org -f org-texinfo+export-to-texinfo
 	@echo >> with-editor.texi
 
diff --git a/Makefile b/Makefile
index 1fa0e8c..330dd03 100644
--- a/Makefile
+++ b/Makefile
@@ -83,7 +83,7 @@ test:
 	(ert-run-tests-batch-and-exit))"
 
 test-interactive:
-	@$(EMACSBIN) -Q $(LOAD_PATH) --eval "(progn\
+	@$(EMACSBIN) -q $(LOAD_PATH) --eval "(progn\
 	(load-file \"t/magit-tests.el\")\
 	(ert t))"
 
diff --git a/default.mk b/default.mk
index a69bed1..ab51b0f 100644
--- a/default.mk
+++ b/default.mk
@@ -85,7 +85,7 @@ endif
 
 endif # ifndef LOAD_PATH
 
-BATCH = $(EMACSBIN) -batch -Q $(LOAD_PATH)
+BATCH = $(EMACSBIN) -batch -q $(LOAD_PATH)
 
 EMACSOLD := $(shell $(BATCH) --eval \
   "(and (version< emacs-version \"$(EMACS_VERSION)\") (princ \"true\"))")
