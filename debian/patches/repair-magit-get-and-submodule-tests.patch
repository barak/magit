From: Kyle Meyer <kyle@kyleam.com>
Date: Sat, 24 Dec 2022 16:44:54 +0100
Subject: Repair magit-get and magit-toplevel:submodule tests

Origin: upstream, https://github.com/magit/magit/commit/36059e0b881cb1465cb5ad0099e55e00845a8222
--- a/t/magit-tests.el
+++ b/t/magit-tests.el
@@ -24,7 +24,11 @@
   (declare (indent 0) (debug t))
   (let ((dir (make-symbol "dir")))
     `(let ((,dir (file-name-as-directory (make-temp-file "magit-" t)))
-           (process-environment process-environment))
+           (process-environment process-environment)
+           (magit-git-global-arguments
+            (nconc
+             (list "-c" "protocol.file.allow=always")
+                   magit-git-global-arguments)))
        (push "GIT_AUTHOR_NAME=A U Thor" process-environment)
        (push "GIT_AUTHOR_EMAIL=a.u.thor@example.com" process-environment)
        (condition-case err
